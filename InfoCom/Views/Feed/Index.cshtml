@using Microsoft.AspNet.Identity
@model InfoCom.ViewModels.PostViewModel
@{
    ViewBag.Title = "Feed";
    Layout = "~/Views/Shared/_Layout.cshtml";

}
<div class="col-lg-4 pull-right">
    <div class="well">
        <a href="@Url.Action("Post", "Feed")" class="btn btn-block btn-primary"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Write new blog post</a>
    </div>
    <div class="well" id="feed-settings-well">
        <h4>Feed settings</h4>
        @using (Html.BeginForm("Index", "Feed", FormMethod.Post, new { id = "feed-settings" }))
        {
            <div class="form-group">

                <label class="radio-inline">
                    @Html.RadioButtonFor(m => m.Formal, "All") All
                </label>

                <label class="radio-inline">
                    @Html.RadioButtonFor(m => m.Formal, "Formal") Formal
                </label>
                <label class="radio-inline">
                    @Html.RadioButtonFor(m => m.Formal, "Informal") Informal
                </label>
            </div>
            <div class="form-group">
                <label>Category</label>
                @Html.DropDownListFor(model => model.CategoryId, Model.Categories, htmlAttributes: new { @class = "form-control", @id = "selected-category" })
            </div>

            if (User.IsInRole("Admin"))
            {
                <div class="checkbox">
                    <label><input type="checkbox" value="" checked="checked">Show hidden posts</label>
                </div>
            }
            <input class="btn btn-block btn-primary" type="submit" value="Save" />
        }
    </div>

    <div class="well">
        <h4>Calendar</h4>
        <div id="calendar-container">
            <div id="calendar-center">
                <div id="calendar"></div>
            </div>
        </div>

    </div>


</div>

@foreach (var item in Model.PostList)
{
    <div class="col-lg-8">
        @if (item.Formal)
                {
            <h1>@item.Title (Formal)</h1>
        }
        else
        {
            <h1>@item.Title (Informal)</h1>
        }

        <p class="lead">
            by @item.Author.Username
        </p>
        <p><span class="glyphicon glyphicon-time"></span> Posted on @item.CreatedAt.DayOfWeek.ToString() @item.CreatedAt.ToString("MMM") @item.CreatedAt.Month, @item.CreatedAt.Year at @item.CreatedAt.ToString("HH:mm tt")</p>
       
        <hr>
        @if (Model.FileList != null)
        {
            foreach (var item2 in item.Files)
            {
                if (item2.Post.Id == item.Id)
                {
                    <img class="img-responsive" src="@item2.FilePath" alt="">
                }

            }
        }
        
        

        <hr>

        <p>
            @(item.Content.Length > 200 ? item.Content.Substring(0, 300) + "..." : item.Content)
        </p>

        <hr>
        <button class="btn btn-primary">Read more</button>
        @if (item.Author.Id == Convert.ToInt32(User.Identity.GetUserId()) || User.IsInRole("Admin"))
                {
            <button class="btn btn-danger">Hide this post</button>
        }
        <hr />
    </div>
}
@section Scripts {
    @Scripts.Render("~/Scripts/jquery-ui-1.12.1.js")
    @Scripts.Render("~/Scripts/calendarScripts.js")
}

@*<div class="postcontainer" padding="30">
        <div class="buttonMenu">
            <input type="button" value="New post" id="postBtn" class="btn-primary" onclick="@("window.location.href='" + @Url.Action("Post", "Feed") + "'");" />
        </div>
        <div class="feed">

            @foreach (var item in Model.PostList)
            {

            if (item.Formal == true)
            {
                <div class="Formal">
                    <div class="text-center, border1">
                        <span class="text-post2">
                            @Html.DisplayFor(modelItem => item.Title) <br />
                        </span>
                        <div class="text-title1">
                            Posted by:  @Html.DisplayFor(modelItem => item.Author.Name)<br />
                        </div>


                        <div>
                            @Html.DisplayFor(modelItem => item.Content) <br />
                        </div>

                        <div class="date-separator">
                            @Html.DisplayFor(modelItem => item.CreatedAt)
                        </div>





                    </div>
                </div>

            }
            else
            {
                <div class="Informal">
                    <div class="text-center, border1">
                        <span class="text-post2">
                            @Html.DisplayFor(modelItem => item.Title) <br />
                        </span>
                        <div class="text-title1">
                            Posted by:  @Html.DisplayFor(modelItem => item.Author.Name)<br />
                        </div>


                        <div>
                            @Html.DisplayFor(modelItem => item.Content) <br />
                        </div>

                        <div class="date-separator">
                            @Html.DisplayFor(modelItem => item.CreatedAt)
                        </div>





                    </div>
                </div>

                }



            }
        </div>
    </div>

    <script type="text/javascript" src="~/Scripts/jHtmlArea-0.8.js">
        $(document).ready(function () {
            $('textarea').htmlarea();
        });

    </script>

            }*@
