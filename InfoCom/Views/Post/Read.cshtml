@using Microsoft.AspNet.Identity
@model InfoCom.ViewModels.ReadViewModel
@{
    ViewBag.Title = "Read";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="col-lg-4 pull-right">
    <div class="well">
        <a href="@Url.Action("Index", "Post")" class="btn btn-block btn-primary"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Write new blog post</a>
    </div>

    <div class="well">
        <div id="calendar-container">
            <div id="calendar-center">
                <div id="calendar"></div>
            </div>
        </div>
        <div id="event-content"></div>
    </div>


</div>

<div class="col-lg-8">

    @if (Model.Post.Formal)
            {
        <h1>@Model.Post.Title (Formal)</h1>

    }
    else
    {
        <h1>@Model.Post.Title (Informal)</h1>
    }

    <p class="lead">
        by @Model.Post.Author.Username
    </p>
    <p><span class="glyphicon glyphicon-time"></span> Posted on @Model.Post.CreatedAt.DayOfWeek.ToString() @Model.Post.CreatedAt.ToString("MMM") @Model.Post.CreatedAt.Month, @Model.Post.CreatedAt.Year at @Model.Post.CreatedAt.ToString("HH:mm tt")</p>
    @foreach (var file in Model.Post.Files)
    {
    if (file.Post.Id == Model.Post.Id && file.FilePath.EndsWith(".jpg") || file.FilePath.EndsWith(".png") || file.FilePath.EndsWith(".GIF"))
    {

    <img class="img-responsive" src="@Url.Content(file.FilePath)" alt="@file.Id">

 

    }
    if (file.FilePath.EndsWith(".rtf")
    || file.FilePath.EndsWith(".pdf")
    || file.FilePath.EndsWith(".docx")
    || file.FilePath.EndsWith(".doc")
    || file.FilePath.EndsWith(".txt")
    || file.FilePath.EndsWith(".ppt")
    || file.FilePath.EndsWith(".xls")
    || file.FilePath.EndsWith(".xlsx") && file.Post.Id ==Model.Id)

    {

    <a href="@Url.Content(@file.FilePath)">@file.FilePath.Substring(12)</a>
    }

    }
    
    <hr>
    <hr>

    <p>
        @Model.Post.Content
    </p>

    <hr>
    @if (Model.Post.Author.Id == Convert.ToInt32(User.Identity.GetUserId()) || User.IsInRole("Admin"))
    {
        if (!Model.Post.Inactive)
        {
            <button class="btn btn-danger">Hide this post</button>
        }
        else
        {
            <button class="btn btn-success">Show this post</button>
        }

    }
    <hr />
    @if (Model.Post.Comments.Any())
    {
        foreach (var comment in Model.Post.Comments)
        {
            <h4>@comment.Author.Username</h4>
            @comment.CreatedAt
            <br/>
            @comment.Content
        }
    }
    else
    {
        <h4>This post has no comments :(</h4>
    }
</div>
@section Scripts {
    @Scripts.Render("~/Scripts/jquery-ui-1.12.1.js")
    @Scripts.Render("~/Scripts/calendarScripts.js")
}